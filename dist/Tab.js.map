{"version":3,"sources":["../src/Tab.js"],"sourcesContent":["import Hypermap from './Hypermap.js';\n\nexport default class Tab extends EventTarget {\n\tpage;\n\n\tconstructor(page) {\n\t\tsuper();\n\t\tthis.page = page;\n\t}\n\n\tasync goto(...args) {\n\t\tawait this.page.goto(...args);\n\t}\n\n\turl() {\n\t\treturn this.page.url();\n\t}\n\n\tasync data() {\n\t\tconst hypermapJson = await this.page.evaluate(() => {\n\t\t\treturn globalThis.serializedHypermap();\n\t\t});\n\t\treturn Hypermap.fromJSON(hypermapJson, [], [], null, this);\n\t}\n\n\tasync fetch(path) {\n\t\tconst node = (await this.data()).at(...path);\n\t\tif (node.attributes.rels?.includes('transclude')) {\n\t\t\tawait this.page.evaluate(async path => {\n\t\t\t\tawait globalThis.hypermap.at(...path).fetch();\n\t\t\t}, path);\n\t\t} else {\n\t\t\tawait Promise.all([\n\t\t\t\tthis.page.waitForNavigation(),\n\t\t\t\tthis.page.evaluate(path => {\n\t\t\t\t\tglobalThis.hypermap.at(...path).fetch();\n\t\t\t\t}, path)\n\t\t\t]);\n\t\t}\n\t}\n\n\tasync set(path, value) {\n\t\tawait this.page.evaluate((path, value) => {\n\t\t\tglobalThis.hypermap.at(...path.slice(0, -1)).set(path.at(-1), value);\n\t\t}, path, value);\n\t}\n}\n"],"names":["Tab","EventTarget","page","constructor","goto","args","url","data","hypermapJson","evaluate","globalThis","serializedHypermap","Hypermap","fromJSON","fetch","path","node","at","attributes","rels","includes","hypermap","Promise","all","waitForNavigation","set","value","slice"],"mappings":";;;;+BAEA;;aAAqBA;;iEAFA;;;;;;AAEN,MAAMA,YAAYC;IAChCC,KAAK;IAELC,YAAYD,IAAI,CAAE;QACjB,KAAK;QACL,IAAI,CAACA,IAAI,GAAGA;IACb;IAEA,MAAME,KAAK,GAAGC,IAAI,EAAE;QACnB,MAAM,IAAI,CAACH,IAAI,CAACE,IAAI,IAAIC;IACzB;IAEAC,MAAM;QACL,OAAO,IAAI,CAACJ,IAAI,CAACI,GAAG;IACrB;IAEA,MAAMC,OAAO;QACZ,MAAMC,eAAe,MAAM,IAAI,CAACN,IAAI,CAACO,QAAQ,CAAC,IAAM;YACnD,OAAOC,WAAWC,kBAAkB;QACrC;QACA,OAAOC,iBAAQ,CAACC,QAAQ,CAACL,cAAc,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI;IAC1D;IAEA,MAAMM,MAAMC,IAAI,EAAE;QACjB,MAAMC,OAAO,AAAC,CAAA,MAAM,IAAI,CAACT,IAAI,EAAC,EAAGU,EAAE,IAAIF;QACvC,IAAIC,KAAKE,UAAU,CAACC,IAAI,EAAEC,SAAS,eAAe;YACjD,MAAM,IAAI,CAAClB,IAAI,CAACO,QAAQ,CAAC,OAAMM,OAAQ;gBACtC,MAAML,WAAWW,QAAQ,CAACJ,EAAE,IAAIF,MAAMD,KAAK;YAC5C,GAAGC;QACJ,OAAO;YACN,MAAMO,QAAQC,GAAG,CAAC;gBACjB,IAAI,CAACrB,IAAI,CAACsB,iBAAiB;gBAC3B,IAAI,CAACtB,IAAI,CAACO,QAAQ,CAACM,CAAAA,OAAQ;oBAC1BL,WAAWW,QAAQ,CAACJ,EAAE,IAAIF,MAAMD,KAAK;gBACtC,GAAGC;aACH;QACF,CAAC;IACF;IAEA,MAAMU,IAAIV,IAAI,EAAEW,KAAK,EAAE;QACtB,MAAM,IAAI,CAACxB,IAAI,CAACO,QAAQ,CAAC,CAACM,MAAMW,QAAU;YACzChB,WAAWW,QAAQ,CAACJ,EAAE,IAAIF,KAAKY,KAAK,CAAC,GAAG,CAAC,IAAIF,GAAG,CAACV,KAAKE,EAAE,CAAC,CAAC,IAAIS;QAC/D,GAAGX,MAAMW;IACV;AACD"}