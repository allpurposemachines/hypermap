{"version":3,"sources":["../src/Mech.js"],"sourcesContent":["import puppeteer from 'puppeteer';\nimport * as fs from 'fs';\nimport Tab from './Tab.js';\n\nexport default class Mech {\n\t/** @type { puppeteer.Browser= } */\n\t#browser;\n\n\tstatic async launch() {\n\t\tconst mech = new Mech();\n\t\tmech.#browser = await puppeteer.launch();\n\t\treturn mech;\n\t}\n\n\t/** @param { { debug?: boolean } } options */\n\tasync newTab(options = {}) {\n\t\tif (!this.#browser) {\n\t\t\tthrow new Error('Mech not launched yet');\n\t\t}\n\n\t\tconst page = await this.#browser.newPage();\n\n\t\tif (options.debug) {\n\t\t\tawait page.setRequestInterception(true);\n\t\t\tpage.on('console', msg => console.log('PAGE LOG:', msg.text()));\n\t\t}\n\n\t\tawait page.exposeFunction('contentChanged', () => {\n\t\t\tpage.emit('contentchanged');\n\t\t});\n\n\t\tconst shim = fs.readFileSync(new URL('assets/shim.js', import.meta.url), 'utf8');\n\t\tpage.on('load', async () => {\n\t\t\tawait page.evaluate(shim);\n\t\t});\n\n\t\treturn new Tab(page);\n\t}\n\n\tasync tabs() {\n\t\treturn await this.#browser?.pages();\n\t}\n\n\tasync close() {\n\t\tawait this.#browser?.close();\n\t}\n}\n\nexport { Tab };\n"],"names":["Mech","Tab","browser","launch","mech","puppeteer","newTab","options","Error","page","newPage","debug","setRequestInterception","on","msg","console","log","text","exposeFunction","emit","shim","fs","readFileSync","URL","evaluate","tabs","pages","close"],"mappings":";;;;;;;;;;;IAIA,OA0CC,MA1CoBA;IA4CZC,GAAG,MAAHA,YAAG;;kEAhDU;4DACF;4DACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAED,MAAMD;IACpB,iCAAiC,GACjC,CAACE,OAAO,CAAC;IAET,aAAaC,SAAS;QACrB,MAAMC,OAAO,IAAIJ;QACjBI,KAAK,CAACF,OAAO,GAAG,MAAMG,kBAAS,CAACF,MAAM;QACtC,OAAOC;IACR;IAEA,2CAA2C,GAC3C,MAAME,OAAOC,UAAU,CAAC,CAAC,EAAE;QAC1B,IAAI,CAAC,IAAI,CAAC,CAACL,OAAO,EAAE;YACnB,MAAM,IAAIM,MAAM,yBAAyB;QAC1C,CAAC;QAED,MAAMC,OAAO,MAAM,IAAI,CAAC,CAACP,OAAO,CAACQ,OAAO;QAExC,IAAIH,QAAQI,KAAK,EAAE;YAClB,MAAMF,KAAKG,sBAAsB,CAAC,IAAI;YACtCH,KAAKI,EAAE,CAAC,WAAWC,CAAAA,MAAOC,QAAQC,GAAG,CAAC,aAAaF,IAAIG,IAAI;QAC5D,CAAC;QAED,MAAMR,KAAKS,cAAc,CAAC,kBAAkB,IAAM;YACjDT,KAAKU,IAAI,CAAC;QACX;QAEA,MAAMC,OAAOC,IAAGC,YAAY,CAAC,IAAIC,IAAI,kBAAkB,sDAAkB;QACzEd,KAAKI,EAAE,CAAC,QAAQ,UAAY;YAC3B,MAAMJ,KAAKe,QAAQ,CAACJ;QACrB;QAEA,OAAO,IAAInB,YAAG,CAACQ;IAChB;IAEA,MAAMgB,OAAO;QACZ,OAAO,MAAM,IAAI,CAAC,CAACvB,OAAO,EAAEwB;IAC7B;IAEA,MAAMC,QAAQ;QACb,MAAM,IAAI,CAAC,CAACzB,OAAO,EAAEyB;IACtB;AACD"}